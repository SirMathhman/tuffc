// Test Set<T> implementation using the advanced type system

let { set_new, set_add, set_has, set_delete } = selfhost::runtime_lexer;

fn test_set_basic() : Bool => {
    let s = set_new();
    s = set_add(s, 42);
    s = set_add(s, 100);
    s = set_add(s, 7);
    
    let has42 = set_has(s, 42);
    let has100 = set_has(s, 100);
    let has7 = set_has(s, 7);
    let has999 = set_has(s, 999);
    
    has42 && has100 && has7 && !has999
}

fn test_set_delete() : Bool => {
    let s = set_new();
    s = set_add(s, 1);
    s = set_add(s, 2);
    s = set_add(s, 3);
    
    let had1 = set_has(s, 1);
    set_delete(s, 1);
    let lost1 = !set_has(s, 1);
    let kept2 = set_has(s, 2);
    
    had1 && lost1 && kept2
}

fn main() : I32 => {
    let basic = test_set_basic();
    let delete = test_set_delete();
    
    if (basic && delete) 0 else 1
}
