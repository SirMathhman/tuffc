 // Test Set<T> implementation using the advanced type system
let {
    setNew, setAdd, setHas, setDelete
}
 = selfhost::runtimeLexer;
fn testSetBasic() : Bool => {
    let s = setNew();
    s = setAdd(s, 42);
    s = setAdd(s, 100);
    s = setAdd(s, 7);
    let has42 = setHas(s, 42);
    let has100 = setHas(s, 100);
    let has7 = setHas(s, 7);
    let has999 = setHas(s, 999);
    has42 && has100 && has7 && !has999
}
fn testSetDelete() : Bool => {
    let s = setNew();
    s = setAdd(s, 1);
    s = setAdd(s, 2);
    s = setAdd(s, 3);
    let had1 = setHas(s, 1);
    setDelete(s, 1);
    let lost1 = !setHas(s, 1);
    let kept2 = setHas(s, 2);
    had1 && lost1 && kept2
}
fn main() : I32 => {
    let basic = testSetBasic();
    let delete = testSetDelete();
    if (basic && delete) 0 else 1
}
